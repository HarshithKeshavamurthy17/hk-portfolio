import{j as e,B as s}from"./index-Bv-VGaEE.js";import{C as r}from"./CaseLayout-mihoD_PU.js";function n(){return e.jsx(r,{title:"VI-Graph-RAG",summary:"Graph-aware retrieval augmented generation pipeline powering faster CVE triage and analyst Q&A across multi-vendor advisories.",timeline:"2024",caseRole:"Lead ML Engineer",slug:"vi-graph-rag",tags:["RAG","Graph","Security"],sections:{problem:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{children:"Security analysts were drowning in duplicated CVE writeups, inconsistent CWE mappings, and ad-hoc ticket notes. The team needed a single triage assistant that could unify vulnerability metadata, surface related weaknesses, and answer remediation questions in context."}),e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"Correlate CVE → CWE relationships across noisy vendor advisory feeds."}),e.jsx("li",{children:"Support conversational triage so analysts could ask impact and remediation questions."}),e.jsx("li",{children:"Shorten time-to-first-action (MTTR proxy) without degrading precision."})]})]}),data:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{children:"Primary sources feeding the graph and retrieval index:"}),e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"National Vulnerability Database CVEs (2002–2024) delivered as JSON feeds."}),e.jsx("li",{children:"Common Weakness Enumeration XML exports updated quarterly."}),e.jsx("li",{children:"Vendor advisory texts (Red Hat, Microsoft, VMware) scraped and normalized."})]}),e.jsx("p",{children:"All artifacts were normalized to internal identifiers and versioned inside an ingestion lake (Delta tables) before being projected into Neo4j and FAISS."})]}),approach:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{children:"Hybrid retrieval workflow blending dense embeddings, reranking, and graph traversal:"}),e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"BGE-large-en embeddings for paragraph-level chunks (768-dim)."}),e.jsxs("li",{children:["FAISS HNSW index tuned for ",e.jsx("code",{children:"efSearch=128"})," to balance latency and recall."]}),e.jsx("li",{children:"Cross-Encoder (ms-marco-MiniLM-L-6-v2) reranking top-50 hits down to actionable top-10."}),e.jsxs("li",{children:["Graph-RAG expansion across Neo4j using ",e.jsx("code",{children:":INDICATES_WEAKNESS_IN"})," and vendor adjacency edges to surface related CVEs/CWEs."]}),e.jsx("li",{children:"FastAPI service orchestrating retrieval and answer synthesis; Streamlit UI for analyst workflows."})]})]}),architecture:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("ol",{className:"list-decimal space-y-2 pl-6",children:[e.jsx("li",{children:"Ingestion jobs normalize CVE, CWE, and advisory feeds into a Delta-backed staging area."}),e.jsx("li",{children:"Embedding workers chunk documents (350 tokens, 40-token overlap) and push vectors into FAISS."}),e.jsx("li",{children:"Query path hits FAISS → top-50 results reranked by cross-encoder."}),e.jsxs("li",{children:["Top reranked nodes seed Cypher traversal (2–3 hops) across"," ",e.jsx("code",{children:":INDICATES_WEAKNESS_IN"})," edges."]}),e.jsx("li",{children:"Response composer synthesizes findings with templated reasoning and citation snippets."})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deployed on Azure Kubernetes Service with Redis caching for embeddings and rerank payloads."})]}),decisions:e.jsx("div",{className:"space-y-3",children:e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"Settled on 350-token chunk size after ablations balancing context coherence and latency."}),e.jsx("li",{children:"Normalized CVE/CWE IDs to internal UUIDs to dedupe aliases from vendor feeds."}),e.jsx("li",{children:"Evaluation harness tracked precision@k / recall@k on curated triage questions."}),e.jsx("li",{children:"Latency budget < 1.2s at P95; enforced via FAISS search params and async Cypher limits."})]})}),results:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"Precision@5 improved from 0.42 → 0.68 on analyst benchmark set."}),e.jsx("li",{children:"Median MTTR proxy (time-to-first-action) dropped by 36% in pilot teams."}),e.jsx("li",{children:"Avoided costly brute-force reranking by caching FAISS hits and sharing graph traversals."})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trade-off: cross-encoder reranking added ~180ms per query but delivered materially better precision."})]}),improvements:e.jsx("div",{className:"space-y-3",children:e.jsxs("ul",{className:"list-disc space-y-2 pl-6",children:[e.jsx("li",{children:"Boost entity linking for vendor-specific identifiers (e.g., RHSA IDs) feeding the graph."}),e.jsx("li",{children:"Ablate E5-large embeddings for higher recall while monitoring latency."}),e.jsx("li",{children:"Introduce cached rerank results for frequent CVE patterns to shave additional 120ms."})]})}),links:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(s,{asChild:!0,children:e.jsx("a",{href:"https://github.com/harinik/vi-graph-rag",target:"_blank",rel:"noreferrer",children:"View Code"})}),e.jsx(s,{asChild:!0,variant:"outline",children:e.jsx("a",{href:"https://harinik.dev/demos/vi-graph-rag",target:"_blank",rel:"noreferrer",children:"See Demo"})}),e.jsx(s,{asChild:!0,variant:"ghost",children:e.jsx("a",{href:"https://harinik.dev/files/vi-graph-rag-one-pager.pdf",target:"_blank",rel:"noreferrer",children:"One-Pager PDF"})})]})}})}export{n as VIGraphRAG,n as default};
